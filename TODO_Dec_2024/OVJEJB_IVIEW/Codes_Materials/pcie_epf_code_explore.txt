


	/* allocate from epc address space*/
	src_addr = pci_epc_mem_alloc_addr(epc, &phys_addr, reg->size);
	

	/* map CPU address to PCI address
	 * phys_addr - physical address of local system.
	 * reg->src_addr - PCI address to which the physical address should be mapped
	 * reg->size - size of allocation
	 */
	ret = pci_epc_map_addr(epc, epf->func_no, epf->vfunc_no, phys_addr,
			       reg->src_addr, reg->size);
	
	buf = kzalloc(reg->size, GFP_KERNEL);
	
	dst_phys_addr = dma_map_single(dma_dev, buf, reg->size,
					       DMA_FROM_DEVICE);					   
	
	ret = pci_epf_test_data_transfer(epf_test, dst_phys_addr,
			phys_addr, reg->size);
			
	dma_unmap_single(dma_dev, dst_phys_addr, reg->size,
				 DMA_FROM_DEVICE);
				 
				 